<?xml version="1.0" encoding="UTF-8"?><Graph author="scalvillo" created="Fri Jun 10 20:56:50 EDT 2016" guiVersion="3.4.4.P" id="1466014046265" licenseType="Commercial" modified="Mon May 01 17:02:10 EDT 2017" modifiedBy="richdevine" name="Complete County File" revision="1.286" showComponentDetails="true">
<Global>
<Metadata id="Metadata3" previewAttachment="${DATA_TMP_DIR}/enigma-us.gov.dol.oflc.h1b.2014-56e1326ac5eb020a9c4727d1eb8d96e6.csv" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="," label="enigma-us.gov.dol.oflc.h1b.2014-56e1326ac5eb020a9c4727d1eb8d96e6.csv" name="enigma_h1b_2014_read" previewAttachment="${DATA_TMP_DIR}/enigma-us.gov.dol.oflc.h1b.2014-56e1326ac5eb020a9c4727d1eb8d96e6.csv" previewAttachmentCharset="ISO-8859-1" quoteChar="&quot;" quotedStrings="true" recordDelimiter="\n" skipSourceRows="1" type="delimited">
<Field name="lca_case_number" type="string"/>
<Field name="status" type="string"/>
<Field name="lca_case_submit" type="string"/>
<Field name="decision_date" type="string"/>
<Field name="visa_class" type="string"/>
<Field name="lca_case_employment_start_date" type="string"/>
<Field name="lca_case_employment_end_date" type="string"/>
<Field name="lca_case_employer_name" type="string"/>
<Field name="lca_case_employer_address" type="string"/>
<Field name="lca_case_employer_city" type="string"/>
<Field name="lca_case_employer_state" type="string"/>
<Field name="lca_case_employer_postal_code" type="string"/>
<Field name="lca_case_soc_code" type="string"/>
<Field name="lca_case_soc_name" type="string"/>
<Field name="lca_case_job_title" type="string"/>
<Field name="lca_case_wage_rate_from" type="string"/>
<Field name="lca_case_wage_rate_to" type="string"/>
<Field name="lca_case_wage_rate_unit" type="string"/>
<Field name="full_time_pos" type="string"/>
<Field name="total_workers" type="string"/>
<Field name="lca_case_workloc1_city" type="string"/>
<Field name="lca_case_workloc1_state" type="string"/>
<Field name="pw_1" type="string"/>
<Field name="pw_unit_1" type="string"/>
<Field name="pw_source_1" type="string"/>
<Field name="other_wage_source_1" type="string"/>
<Field name="yr_source_pub_1" type="string"/>
<Field name="lca_case_workloc2_city" type="string"/>
<Field name="lca_case_workloc2_state" type="string"/>
<Field name="pw_2" type="string"/>
<Field name="pw_unit_2" type="string"/>
<Field name="pw_source_2" type="string"/>
<Field name="other_wage_source_2" type="string"/>
<Field name="yr_source_pub_2" type="string"/>
<Field name="lca_case_naics_code" type="string"/>
<Field eofAsDelimiter="false" name="serialid" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata0" previewAttachment="${DATA_TMP_DIR}/enigma-us.gov.dol.oflc.h1b.2015-1de8f4426080254cb7e8e66b24fdf21b.csv" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="," label="enigma_h1b_2015_read" name="enigma_h1b_2015_read" previewAttachment="${DATA_TMP_DIR}/enigma-us.gov.dol.oflc.h1b.2015-1de8f4426080254cb7e8e66b24fdf21b.csv" previewAttachmentCharset="ISO-8859-1" quoteChar="&quot;" quotedStrings="true" recordDelimiter="\n" skipSourceRows="1" type="delimited">
<Field name="case_number" type="string"/>
<Field name="case_status" type="string"/>
<Field name="case_submitted" type="string"/>
<Field name="decision_date" type="string"/>
<Field name="visa_class" type="string"/>
<Field name="employment_start_date" type="string"/>
<Field name="employment_end_date" type="string"/>
<Field name="employer_name" type="string"/>
<Field name="employer_address1" type="string"/>
<Field name="employer_address2" type="string"/>
<Field name="employer_city" type="string"/>
<Field name="employer_state" type="string"/>
<Field name="employer_postal_code" type="string"/>
<Field name="employer_country" type="string"/>
<Field name="employer_province" nullValue="N/A" type="string"/>
<Field name="employer_phone" type="string"/>
<Field name="employer_phone_ext" type="string"/>
<Field name="agent_attorney_name" type="string"/>
<Field name="agent_attorney_city" type="string"/>
<Field name="agent_attorney_state" type="string"/>
<Field name="job_title" type="string"/>
<Field name="soc_code" type="string"/>
<Field name="soc_name" type="string"/>
<Field name="naic_code" type="string"/>
<Field name="total_workers" type="string"/>
<Field name="full_time_position" type="string"/>
<Field name="prevailing_wage" type="string"/>
<Field name="pw_unit_of_pay" type="string"/>
<Field name="pw_wage_level" type="string"/>
<Field name="pw_source" type="string"/>
<Field name="pw_wage_source_year" type="string"/>
<Field name="pw_source_other" type="string"/>
<Field name="wage_rate_of_pay" type="string"/>
<Field name="wage_unit_of_pay" type="string"/>
<Field name="h1b_dependent" type="string"/>
<Field name="willful_violator" type="string"/>
<Field name="worksite_city" type="string"/>
<Field name="worksite_county" type="string"/>
<Field name="worksite_state" type="string"/>
<Field name="worksite_postal_code" type="string"/>
<Field eofAsDelimiter="false" name="serialid" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata1" previewAttachment="${DATA_TMP_DIR}/enigma-us.gov.dol.oflc.h1b.2016-678dc110773e3d904d73641a47105e72.csv" previewAttachmentCharset="UTF-8">
<Record fieldDelimiter="," label="enigma_h1b_2016_read" name="enigma_h1b_2016_read" previewAttachment="${DATA_TMP_DIR}/enigma-us.gov.dol.oflc.h1b.2016-678dc110773e3d904d73641a47105e72.csv" previewAttachmentCharset="UTF-8" quoteChar="&quot;" quotedStrings="true" recordDelimiter="\n" skipSourceRows="1" type="delimited">
<Field name="case_number" type="string"/>
<Field name="case_status" type="string"/>
<Field name="case_submitted" type="string"/>
<Field name="decision_date" type="string"/>
<Field name="visa_class" type="string"/>
<Field name="employment_start_date" type="string"/>
<Field name="employment_end_date" type="string"/>
<Field name="employer_name" type="string"/>
<Field name="employer_address" type="string"/>
<Field name="employer_city" type="string"/>
<Field name="employer_state" type="string"/>
<Field name="employer_postal_code" type="string"/>
<Field name="employer_country" type="string"/>
<Field name="employer_province" nullValue="&quot;N/A&quot;,&quot;N|A&quot;" type="string"/>
<Field name="employer_phone" type="string"/>
<Field name="employer_phone_ext" type="string"/>
<Field name="agent_attorney_name" type="string"/>
<Field name="agent_attorney_city" type="string"/>
<Field name="agent_attorney_state" type="string"/>
<Field name="job_title" type="string"/>
<Field name="soc_code" type="string"/>
<Field name="soc_name" type="string"/>
<Field name="naic_code" type="string"/>
<Field name="total_workers" type="string"/>
<Field name="full_time_position" type="string"/>
<Field name="prevailing_wage" type="string"/>
<Field name="pw_unit_of_pay" type="string"/>
<Field name="pw_wage_source" type="string"/>
<Field name="pw_wage_source_year" type="string"/>
<Field name="pw_wage_source_other" type="string"/>
<Field name="wage_rate_of_pay_from" type="string"/>
<Field name="wage_rate_of_pay_to" type="string"/>
<Field name="wage_unit_of_pay" type="string"/>
<Field name="h1b_dependent" type="string"/>
<Field name="willful_violator" type="string"/>
<Field name="worksite_city" type="string"/>
<Field name="worksite_county" type="string"/>
<Field name="worksite_state" type="string"/>
<Field name="worksite_postal_code" type="string"/>
<Field name="original_cert_date" type="string"/>
<Field name="blank_column" type="string"/>
<Field eofAsDelimiter="false" name="serialid" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata2" previewAttachmentCharset="UTF-8">
<Record fieldDelimiter="|" label="enigma_h1b_combined_write" name="enigma_h1b_combined_write" previewAttachmentCharset="UTF-8" quotedStrings="false" recordDelimiter="\n" recordSize="-1" skipSourceRows="1" type="delimited">
<Field eofAsDelimiter="false" name="case_number" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="case_status" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="case_submitted" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="decision_date" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="visa_class" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employment_start_date" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employment_end_date" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_name" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_address" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_address2" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_city" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_state" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_postal_code" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_country" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_province" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_phone" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="employer_phone_ext" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="agent_attorney_name" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="agent_attorney_city" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="agent_attorney_state" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="job_title" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="soc_code" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="soc_name" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="naic_code" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="total_workers" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="full_time_position" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="prevailing_wage" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="pw_unit_of_pay" nullable="true" shift="0" size="0" type="string"/>
<Field name="pw_wage_level" type="string"/>
<Field eofAsDelimiter="false" name="pw_wage_source" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="pw_wage_source_year" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="pw_wage_source_other" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="wage_rate_of_pay_from" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="wage_rate_of_pay_to" nullable="true" shift="0" size="0" type="string"/>
<Field name="wage_rate_of_pay" type="string"/>
<Field eofAsDelimiter="false" name="wage_unit_of_pay" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="h1b_dependent" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="willful_violator" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="worksite_city" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="worksite_county" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="worksite_state" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="worksite_postal_code" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="original_cert_date" nullable="true" shift="0" size="0" type="string"/>
<Field eofAsDelimiter="false" name="serialid" nullable="true" shift="0" size="0" type="string"/>
</Record>
</Metadata>
<Connection database="DSS" dbURL="jdbc:dss://secure.gooddata.com/gdc/dss/instances/d68eb234fff8f2750cbf7dd02b20fd0e" id="JDBC0" jdbcSpecific="DSS" name="GOODDATA_DEV" password="justcapital1!" type="JDBC" user="ps-etl+justcapital_research@gooddata.com"/>
<Property id="GraphParameter0" name="DOWNLOADFILEPATH" value="https://${S3ACCESSKEY}:${S3SECRETKEY}@${S3BUCKETNAME}.s3.amazonaws.com/ranking/enigma/h1b/*.csv"/>
<Property id="GraphParameter1" name="POPULATEERRORFILEPATH" value="${DATA_TMP_DIR}/enigmah1bvisaerror.txt"/>
<Property id="GraphParameter25" name="READFILEPATH2012" value="${DATA_TMP_DIR}/H1B-enigma-2012.csv"/>
<Property id="GraphParameter4" name="READFILEPATH2013" value="${DATA_TMP_DIR}/H1B-enigma-2013.csv"/>
<Property id="GraphParameter2" name="READFILEPATH2014" value="${DATA_TMP_DIR}/H1B-enigma-2014.csv"/>
<Property id="GraphParameter3" name="READFILEPATH2015" value="${DATA_TMP_DIR}/H1B-enigma-2015.csv"/>
<Property id="GraphParameter5" name="TABLENAME" value="STG_ENIGMAH1BVISA"/>
<Property fileURL="workspace.prm" id="GraphParameter6"/>
<Property id="GraphParameter24" name="WRITEFILEPATH" value="${DATA_TRANSFORM_DIR}/enigmah1bvisawrite.txt"/>
<Dictionary/>
</Global>
<Phase number="0">
<Node baseURL="${DOWNLOADFILEPATH}" destination="${DATA_TMP_DIR}" enabled="enabled" guiName="File Download" guiX="283" guiY="-93" id="FILE_DOWNLOAD" type="FILE_DOWNLOAD"/>
</Phase>
<Phase number="1">
<Node enabled="enabled" fileURL="${READFILEPATH2012}" guiName="Read 2012" guiX="57" guiY="3" id="READ_3" type="DATA_READER" verbose="true"/>
<Node append="false" enabled="enabled" fileURL="${WRITEFILEPATH}" guiName="Write 2012" guiX="418" guiY="3" id="WRITE_2" quotedStrings="false" type="DATA_WRITER"/>
<Node enabled="enabled" guiName="2012" guiX="235" guiY="3" id="_2" type="REFORMAT">
<attr name="transform"><![CDATA[//#CTL2

// Transforms input record into output record.
function integer transform() {
	$out.0.case_number = $in.0.lca_case_number;
	$out.0.case_status = $in.0.status;
	$out.0.case_submitted = $in.0.lca_case_submit;
	$out.0.decision_date = $in.0.decision_date;
	$out.0.visa_class = $in.0.visa_class;
	$out.0.employment_start_date = $in.0.lca_case_employment_start_date;
	$out.0.employment_end_date = $in.0.lca_case_employment_end_date;
	$out.0.employer_name = ($in.0.lca_case_employer_name == null) ? $in.0.lca_case_employer_name : replace($in.0.lca_case_employer_name,"[|]",";");
	$out.0.employer_address = $out.0.employer_address = ($in.0.lca_case_employer_address == null) ? $in.0.lca_case_employer_address : replace($in.0.lca_case_employer_address,"[|]",";");
	$out.0.employer_city = ($in.0.lca_case_employer_city == null) ? $in.0.lca_case_employer_city : replace($in.0.lca_case_employer_city,"[\\\\]","");
	$out.0.employer_state = $in.0.lca_case_employer_state;
	$out.0.employer_postal_code = $in.0.lca_case_employer_postal_code;
	string title = $in.0.lca_case_job_title;
	if(title != null) {
		if(indexOf(title,"|") > 0) {
			title = replace(title,"[|]",";");
		}
		if(indexOf(title,"\\") > 0) {
			title = replace(title,"[\\\\]","");
		}
	}
	$out.0.job_title = title;
	//$out.0.job_title = ($in.0.lca_case_job_title == null) ? $in.0.lca_case_job_title : replace($in.0.lca_case_job_title,"[|]",";");
	$out.0.soc_code = $in.0.lca_case_soc_code;
	$out.0.soc_name = $in.0.lca_case_soc_name;
	$out.0.naic_code = $in.0.lca_case_naics_code;
	$out.0.total_workers = $in.0.total_workers;
	$out.0.full_time_position = $in.0.full_time_pos;
	$out.0.prevailing_wage = $in.0.pw_1;
	$out.0.pw_unit_of_pay = $in.0.pw_unit_1;
	$out.0.pw_wage_source = $in.0.pw_source_1;
	$out.0.pw_wage_source_year = $in.0.yr_source_pub_1;
	$out.0.pw_wage_source_other = ($in.0.other_wage_source_1 == null) ? $in.0.other_wage_source_1 : replace(replace($in.0.other_wage_source_1,"[\\\\]",""),"[|]","-");
	$out.0.wage_rate_of_pay_from = $in.0.lca_case_wage_rate_from;
	$out.0.wage_rate_of_pay_to = $in.0.lca_case_wage_rate_to;
	$out.0.wage_unit_of_pay = $in.0.lca_case_wage_rate_unit;
	$out.0.worksite_city = 	$out.0.worksite_city = ($in.0.lca_case_workloc1_city == null) ? $in.0.lca_case_workloc1_city : replace($in.0.lca_case_workloc1_city,"[\\\\]","");
	$out.0.worksite_state = $in.0.lca_case_workloc1_state;
	$out.0.serialid = $in.0.serialid;

	return ALL;
}

// Called during component initialization.
// function boolean init() {}

// Called during each graph run before the transform is executed. May be used to allocate and initialize resources
// required by the transform. All resources allocated within this method should be released
// by the postExecute() method.
// function void preExecute() {}

// Called only if transform() throws an exception.
// function integer transformOnError(string errorMessage, string stackTrace) {}

// Called during each graph run after the entire transform was executed. Should be used to free any resources
// allocated within the preExecute() method.
// function void postExecute() {}

// Called to return a user-defined error message when an error occurs.
// function string getMessage() {}
]]></attr>
</Node>
<Edge fromNode="READ_3:0" guiBendpoints="" guiRouter="Manhattan" id="Edge4" inPort="Port 0 (in)" metadata="Metadata3" outPort="Port 0 (output)" toNode="_2:0"/>
<Edge fromNode="_2:0" guiBendpoints="" guiRouter="Manhattan" id="Edge1" inPort="Port 0 (in)" metadata="Metadata2" outPort="Port 0 (out)" toNode="WRITE_2:0"/>
</Phase>
<Phase number="2">
<Node baseURL="${READFILEPATH2012}" enabled="enabled" guiName="Clean 2012" guiX="581" guiY="3" id="CLEAN_2" type="FILE_DELETE"/>
<Node enabled="enabled" fileURL="${READFILEPATH2013}" guiName="Read 2013" guiX="57" guiY="107" id="READ_4" type="DATA_READER" verbose="true"/>
<Node append="true" enabled="enabled" fileURL="${WRITEFILEPATH}" guiName="Wriite 2013" guiX="418" guiY="107" id="WRIITE_1" quotedStrings="false" type="DATA_WRITER"/>
<Node enabled="enabled" guiName="2013" guiX="235" guiY="107" id="_3" type="REFORMAT">
<attr name="transform"><![CDATA[//#CTL2

// Transforms input record into output record.
function integer transform() {
	$out.0.case_number = $in.0.case_number;
	$out.0.case_status = $in.0.case_status;
	$out.0.case_submitted = $in.0.case_submitted;
	$out.0.decision_date = $in.0.decision_date;
	$out.0.visa_class = $in.0.visa_class;
	$out.0.employment_start_date = $in.0.employment_start_date;
	$out.0.employment_end_date = $in.0.employment_end_date;
	$out.0.employer_name = ($in.0.employer_name == null) ? $in.0.employer_name : replace($in.0.employer_name,"[|]",";");
	$out.0.employer_address = ($in.0.employer_address1 == null) ? $in.0.employer_address1 : replace($in.0.employer_address1,"[|]",";");
	$out.0.employer_address2 = ($in.0.employer_address2 == null) ? $in.0.employer_address2 : replace($in.0.employer_address2,"[|]",";");
	$out.0.employer_city = $in.0.employer_city;
	$out.0.employer_state = $in.0.employer_state;
	$out.0.employer_postal_code = $in.0.employer_postal_code;
	$out.0.employer_country = $in.0.employer_country;
	$out.0.employer_province = ($in.0.employer_province == null) ? $in.0.employer_province : replace($in.0.employer_province,"[N|A]",";");
	$out.0.employer_phone = $in.0.employer_phone;
	$out.0.employer_phone_ext = $in.0.employer_phone_ext;
	$out.0.agent_attorney_name = $in.0.agent_attorney_name;
	$out.0.agent_attorney_city = $in.0.agent_attorney_city;
	$out.0.agent_attorney_state = $in.0.agent_attorney_state;
	$out.0.job_title = ($in.0.job_title == null) ? $in.0.job_title : replace($in.0.job_title,"[|]",";");
	$out.0.soc_code = $in.0.soc_code;
	$out.0.soc_name = $in.0.soc_name;
	$out.0.naic_code = $in.0.naic_code;
	$out.0.total_workers = $in.0.total_workers;
	$out.0.full_time_position = $in.0.full_time_position;
	$out.0.prevailing_wage = $in.0.prevailing_wage;
	$out.0.pw_unit_of_pay = $in.0.pw_unit_of_pay;
	$out.0.pw_wage_level = $in.0.pw_wage_level;
	$out.0.pw_wage_source_year = $in.0.pw_wage_source_year;
	$out.0.wage_rate_of_pay = $in.0.wage_rate_of_pay;
	$out.0.wage_unit_of_pay = $in.0.wage_unit_of_pay;
	$out.0.h1b_dependent = $in.0.h1b_dependent;
	$out.0.willful_violator = $in.0.willful_violator;
	$out.0.worksite_city = ($in.0.worksite_city == null) ? $in.0.worksite_city : replace($in.0.worksite_city,"[\\\\]","");
	$out.0.worksite_county = ($in.0.worksite_county == null) ? $in.0.worksite_county : replace($in.0.worksite_county,"[\\\\]","");
	$out.0.worksite_state = $in.0.worksite_state;
	$out.0.worksite_postal_code = $in.0.worksite_postal_code;
	$out.0.serialid = $in.0.serialid;

	return ALL;
}

// Called during component initialization.
// function boolean init() {}

// Called during each graph run before the transform is executed. May be used to allocate and initialize resources
// required by the transform. All resources allocated within this method should be released
// by the postExecute() method.
// function void preExecute() {}

// Called only if transform() throws an exception.
// function integer transformOnError(string errorMessage, string stackTrace) {}

// Called during each graph run after the entire transform was executed. Should be used to free any resources
// allocated within the preExecute() method.
// function void postExecute() {}

// Called to return a user-defined error message when an error occurs.
// function string getMessage() {}
]]></attr>
</Node>
<Edge fromNode="READ_4:0" guiBendpoints="" guiRouter="Manhattan" id="Edge2" inPort="Port 0 (in)" metadata="Metadata0" outPort="Port 0 (output)" toNode="_3:0"/>
<Edge fromNode="_3:0" guiBendpoints="" guiRouter="Manhattan" id="Edge10" inPort="Port 0 (in)" metadata="Metadata2" outPort="Port 0 (out)" toNode="WRIITE_1:0"/>
</Phase>
<Phase number="3">
<Node baseURL="${READFILEPATH2013}" enabled="enabled" guiName="Clean 2013" guiX="581" guiY="113" id="CLEAN_3" type="FILE_DELETE"/>
<Node enabled="enabled" fileURL="${READFILEPATH2014}" guiName="Read 2014" guiX="57" guiY="210" id="READ_2" type="DATA_READER" verbose="true"/>
<Node append="true" enabled="enabled" fileURL="${WRITEFILEPATH}" guiName="Write 2014" guiX="418" guiY="210" id="WRITE_1" quotedStrings="false" type="DATA_WRITER"/>
<Node enabled="enabled" guiName="2014" guiX="235" guiY="210" id="_1" type="REFORMAT">
<attr name="transform"><![CDATA[//#CTL2

// Transforms input record into output record.
function integer transform() {
	$out.0.case_number = $in.0.lca_case_number;
	$out.0.case_status = $in.0.status;
	$out.0.case_submitted = $in.0.lca_case_submit;
	$out.0.decision_date = $in.0.decision_date;
	$out.0.visa_class = $in.0.visa_class;
	$out.0.employment_start_date = $in.0.lca_case_employment_start_date;
	$out.0.employment_end_date = $in.0.lca_case_employment_end_date;
	$out.0.employer_name = ($in.0.lca_case_employer_name == null) ? $in.0.lca_case_employer_name : replace($in.0.lca_case_employer_name,"[|]",";");
	$out.0.employer_address = $out.0.employer_address = ($in.0.lca_case_employer_address == null) ? $in.0.lca_case_employer_address : replace($in.0.lca_case_employer_address,"[|]",";");
	$out.0.employer_city = ($in.0.lca_case_employer_city == null) ? $in.0.lca_case_employer_city : replace($in.0.lca_case_employer_city,"[\\\\]","");
	$out.0.employer_state = $in.0.lca_case_employer_state;
	$out.0.employer_postal_code = $in.0.lca_case_employer_postal_code;
	string title = $in.0.lca_case_job_title;
	if(title != null) {
		if(indexOf(title,"|") > 0) {
			title = replace(title,"[|]",";");
		}
		if(indexOf(title,"\\") > 0) {
			title = replace(title,"[\\\\]","");
		}
	}
	$out.0.job_title = title;
	//$out.0.job_title = ($in.0.lca_case_job_title == null) ? $in.0.lca_case_job_title : replace($in.0.lca_case_job_title,"[|]",";");
	$out.0.soc_code = $in.0.lca_case_soc_code;
	$out.0.soc_name = $in.0.lca_case_soc_name;
	$out.0.naic_code = $in.0.lca_case_naics_code;
	$out.0.total_workers = $in.0.total_workers;
	$out.0.full_time_position = $in.0.full_time_pos;
	$out.0.prevailing_wage = $in.0.pw_1;
	$out.0.pw_unit_of_pay = $in.0.pw_unit_1;
	$out.0.pw_wage_source = $in.0.pw_source_1;
	$out.0.pw_wage_source_year = $in.0.yr_source_pub_1;
	$out.0.pw_wage_source_other = ($in.0.other_wage_source_1 == null) ? $in.0.other_wage_source_1 : replace(replace($in.0.other_wage_source_1,"[\\\\]",""),"[|]","-");
	$out.0.wage_rate_of_pay_from = $in.0.lca_case_wage_rate_from;
	$out.0.wage_rate_of_pay_to = $in.0.lca_case_wage_rate_to;
	$out.0.wage_unit_of_pay = $in.0.lca_case_wage_rate_unit;
	$out.0.worksite_city = 	$out.0.worksite_city = ($in.0.lca_case_workloc1_city == null) ? $in.0.lca_case_workloc1_city : replace($in.0.lca_case_workloc1_city,"[\\\\]","");
	$out.0.worksite_state = $in.0.lca_case_workloc1_state;
	$out.0.serialid = $in.0.serialid;

	return ALL;
}

// Called during component initialization.
// function boolean init() {}

// Called during each graph run before the transform is executed. May be used to allocate and initialize resources
// required by the transform. All resources allocated within this method should be released
// by the postExecute() method.
// function void preExecute() {}

// Called only if transform() throws an exception.
// function integer transformOnError(string errorMessage, string stackTrace) {}

// Called during each graph run after the entire transform was executed. Should be used to free any resources
// allocated within the preExecute() method.
// function void postExecute() {}

// Called to return a user-defined error message when an error occurs.
// function string getMessage() {}
]]></attr>
</Node>
<Edge fromNode="READ_2:0" guiBendpoints="" guiRouter="Manhattan" id="Edge9" inPort="Port 0 (in)" metadata="Metadata3" outPort="Port 0 (output)" toNode="_1:0"/>
<Edge fromNode="_1:0" guiBendpoints="" guiRouter="Manhattan" id="Edge8" inPort="Port 0 (in)" metadata="Metadata2" outPort="Port 0 (out)" toNode="WRITE_1:0"/>
</Phase>
<Phase number="4">
<Node baseURL="${READFILEPATH2014}" enabled="enabled" guiName="Clean 2014" guiX="581" guiY="216" id="CLEAN_2014" type="FILE_DELETE"/>
<Node enabled="enabled" fileURL="${READFILEPATH2015}" guiName="Read 2015" guiX="57" guiY="314" id="READ_2015" type="DATA_READER" verbose="true"/>
<Node append="true" enabled="enabled" fileURL="${WRITEFILEPATH}" guiName="Wriite 2015" guiX="418" guiY="314" id="WRIITE_2015" quotedStrings="false" type="DATA_WRITER"/>
<Node enabled="enabled" guiName="2015" guiX="235" guiY="314" id="_2015" type="REFORMAT">
<attr name="transform"><![CDATA[//#CTL2

// Transforms input record into output record.
function integer transform() {
	$out.0.case_number = $in.0.case_number;
	$out.0.case_status = $in.0.case_status;
	$out.0.case_submitted = $in.0.case_submitted;
	$out.0.decision_date = $in.0.decision_date;
	$out.0.visa_class = $in.0.visa_class;
	$out.0.employment_start_date = $in.0.employment_start_date;
	$out.0.employment_end_date = $in.0.employment_end_date;
	$out.0.employer_name = ($in.0.employer_name == null) ? $in.0.employer_name : replace($in.0.employer_name,"[|]",";");
	$out.0.employer_address = ($in.0.employer_address1 == null) ? $in.0.employer_address1 : replace($in.0.employer_address1,"[|]",";");
	$out.0.employer_address2 = ($in.0.employer_address2 == null) ? $in.0.employer_address2 : replace($in.0.employer_address2,"[|]",";");
	$out.0.employer_city = $in.0.employer_city;
	$out.0.employer_state = $in.0.employer_state;
	$out.0.employer_postal_code = $in.0.employer_postal_code;
	$out.0.employer_country = $in.0.employer_country;
	$out.0.employer_province = ($in.0.employer_province == null) ? $in.0.employer_province : replace($in.0.employer_province,"[N|A]",";");
	$out.0.employer_phone = $in.0.employer_phone;
	$out.0.employer_phone_ext = $in.0.employer_phone_ext;
	$out.0.agent_attorney_name = $in.0.agent_attorney_name;
	$out.0.agent_attorney_city = $in.0.agent_attorney_city;
	$out.0.agent_attorney_state = $in.0.agent_attorney_state;
	$out.0.job_title = ($in.0.job_title == null) ? $in.0.job_title : replace($in.0.job_title,"[|]",";");
	$out.0.soc_code = $in.0.soc_code;
	$out.0.soc_name = $in.0.soc_name;
	$out.0.naic_code = $in.0.naic_code;
	$out.0.total_workers = $in.0.total_workers;
	$out.0.full_time_position = $in.0.full_time_position;
	$out.0.prevailing_wage = $in.0.prevailing_wage;
	$out.0.pw_unit_of_pay = $in.0.pw_unit_of_pay;
	$out.0.pw_wage_level = $in.0.pw_wage_level;
	$out.0.pw_wage_source_year = $in.0.pw_wage_source_year;
	$out.0.wage_rate_of_pay = $in.0.wage_rate_of_pay;
	$out.0.wage_unit_of_pay = $in.0.wage_unit_of_pay;
	$out.0.h1b_dependent = $in.0.h1b_dependent;
	$out.0.willful_violator = $in.0.willful_violator;
	$out.0.worksite_city = ($in.0.worksite_city == null) ? $in.0.worksite_city : replace($in.0.worksite_city,"[\\\\]","");
	$out.0.worksite_county = ($in.0.worksite_county == null) ? $in.0.worksite_county : replace($in.0.worksite_county,"[\\\\]","");
	$out.0.worksite_state = $in.0.worksite_state;
	$out.0.worksite_postal_code = $in.0.worksite_postal_code;
	$out.0.serialid = $in.0.serialid;

	return ALL;
}

// Called during component initialization.
// function boolean init() {}

// Called during each graph run before the transform is executed. May be used to allocate and initialize resources
// required by the transform. All resources allocated within this method should be released
// by the postExecute() method.
// function void preExecute() {}

// Called only if transform() throws an exception.
// function integer transformOnError(string errorMessage, string stackTrace) {}

// Called during each graph run after the entire transform was executed. Should be used to free any resources
// allocated within the preExecute() method.
// function void postExecute() {}

// Called to return a user-defined error message when an error occurs.
// function string getMessage() {}
]]></attr>
</Node>
<Edge fromNode="READ_2015:0" guiBendpoints="" guiRouter="Manhattan" id="Edge6" inPort="Port 0 (in)" metadata="Metadata0" outPort="Port 0 (output)" toNode="_2015:0"/>
<Edge fromNode="_2015:0" guiBendpoints="" guiRouter="Manhattan" id="Edge3" inPort="Port 0 (in)" metadata="Metadata2" outPort="Port 0 (out)" toNode="WRIITE_2015:0"/>
</Phase>
<Phase number="5">
<Node baseURL="${READFILEPATH2015}" enabled="enabled" guiName="Clean 2015" guiX="581" guiY="320" id="CLEAN_1" type="FILE_DELETE"/>
<Node dbConnection="JDBC0" enabled="enabled" guiName="CREATE TABLE" guiX="235" guiY="419" id="CREATE_TABLE1" type="DB_EXECUTE">
<attr name="sqlQuery"><![CDATA[DROP TABLE IF EXISTS ${TABLENAME};
CREATE TABLE ${TABLENAME} (

CASE_NUMBER VARCHAR(255),
CASE_STATUS VARCHAR(255),
CASE_SUBMITTED VARCHAR(255),
DECISION_DATE VARCHAR(255),
VISA_CLASS VARCHAR(255),
EMPLOYMENT_START_DATE VARCHAR(255),
EMPLOYMENT_END_DATE VARCHAR(255),
EMPLOYER_NAME VARCHAR(255),
EMPLOYER_ADDRESS VARCHAR(255),
EMPLOYER_ADDRESS2 VARCHAR(255),
EMPLOYER_CITY VARCHAR(255),
EMPLOYER_STATE VARCHAR(255),
EMPLOYER_POSTAL_CODE VARCHAR(255),
EMPLOYER_COUNTRY VARCHAR(255),
EMPLOYER_PROVINCE VARCHAR(255),
EMPLOYER_PHONE VARCHAR(255),
EMPLOYER_PHONE_EXT VARCHAR(255),
AGENT_ATTORNEY_NAME VARCHAR(255),
AGENT_ATTORNEY_CITY VARCHAR(255),
AGENT_ATTORNEY_STATE VARCHAR(255),
JOB_TITLE VARCHAR(255),
SOC_CODE VARCHAR(255),
SOC_NAME VARCHAR(255),
NAIC_CODE VARCHAR(255),
TOTAL_WORKERS VARCHAR(255),
FULL_TIME_POSITION VARCHAR(255),
PREVAILING_WAGE VARCHAR(255),
PW_UNIT_OF_PAY VARCHAR(255),
PW_WAGE_LEVEL VARCHAR(255),
PW_WAGE_SOURCE VARCHAR(255),
PW_WAGE_SOURCE_YEAR VARCHAR(255),
PW_WAGE_SOURCE_OTHER VARCHAR(255),
WAGE_RATE_OF_PAY_FROM VARCHAR(255),
WAGE_RATE_OF_PAY_TO VARCHAR(255),
WAGE_UNIT_OF_PAY VARCHAR(255),
WAGE_RATE_OF_PAY VARCHAR(255),
H1B_DEPENDENT VARCHAR(255),
WILLFUL_VIOLATOR VARCHAR(255),
WORKSITE_CITY VARCHAR(255),
WORKSITE_COUNTY VARCHAR(255),
WORKSITE_STATE VARCHAR(255),
WORKSITE_POSTAL_CODE VARCHAR(255),
ORIGINAL_CERT_DATE VARCHAR(255),
SERIALID VARCHAR(255)
);]]></attr>
</Node>
</Phase>
<Phase number="6">
<Node dbConnection="JDBC0" enabled="enabled" guiName="POPULATE TABLE" guiX="417" guiY="419" id="POPULATE_TABLE1" type="DB_EXECUTE">
<attr name="sqlQuery"><![CDATA[COPY ${TABLENAME} (
CASE_NUMBER,
CASE_STATUS,
CASE_SUBMITTED,
DECISION_DATE,
VISA_CLASS,
EMPLOYMENT_START_DATE,
EMPLOYMENT_END_DATE,
EMPLOYER_NAME,
EMPLOYER_ADDRESS,
EMPLOYER_ADDRESS2,
EMPLOYER_CITY,
EMPLOYER_STATE,
EMPLOYER_POSTAL_CODE,
EMPLOYER_COUNTRY,
EMPLOYER_PROVINCE,
EMPLOYER_PHONE,
EMPLOYER_PHONE_EXT,
AGENT_ATTORNEY_NAME,
AGENT_ATTORNEY_CITY,
AGENT_ATTORNEY_STATE,
JOB_TITLE,
SOC_CODE,
SOC_NAME,
NAIC_CODE,
TOTAL_WORKERS,
FULL_TIME_POSITION,
PREVAILING_WAGE,
PW_UNIT_OF_PAY,
PW_WAGE_LEVEL,
PW_WAGE_SOURCE,
PW_WAGE_SOURCE_YEAR,
PW_WAGE_SOURCE_OTHER,
WAGE_RATE_OF_PAY_FROM,
WAGE_RATE_OF_PAY_TO,
WAGE_UNIT_OF_PAY,
WAGE_RATE_OF_PAY,
H1B_DEPENDENT,
WILLFUL_VIOLATOR,
WORKSITE_CITY,
WORKSITE_COUNTY,
WORKSITE_STATE,
WORKSITE_POSTAL_CODE,
ORIGINAL_CERT_DATE,
SERIALID
)
FROM LOCAL '${WRITEFILEPATH}'
EXCEPTIONS '${POPULATEERRORFILEPATH}'
ABORT ON ERROR;]]></attr>
</Node>
</Phase>
<Phase number="7">
<Node baseURL="${POPULATEERRORFILEPATH}" enabled="enabled" guiName="Clean error" guiX="235" guiY="502" id="CLEAN_ERROR" type="FILE_DELETE"/>
<Node baseURL="${WRITEFILEPATH}" enabled="enabled" guiName="Clean write" guiX="418" guiY="502" id="CLEAN_WRITE" type="FILE_DELETE"/>
</Phase>
</Graph>
