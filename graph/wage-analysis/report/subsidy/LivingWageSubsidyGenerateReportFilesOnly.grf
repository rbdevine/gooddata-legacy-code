<?xml version="1.0" encoding="UTF-8"?><Graph author="hankmobley" created="Thu Sep 15 14:53:16 EDT 2016" description="Load up the living wage distributions." guiVersion="3.4.4.P" id="1473965616523" licenseType="Commercial" modified="Thu Jul 27 11:45:03 EDT 2017" modifiedBy="richdevine" name="LivingWageDistByGOC" revision="1.147" showComponentDetails="true">
<Global>
<Metadata id="Metadata0" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="," name="Details_County" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" type="delimited">
<Field name="STATE_COUNTY_FIPS" size="5" type="string"/>
<Field name="EMP_COUNT_TOTAL" type="string"/>
<Field name="EMP_COUNT_SUBSIDY_TOTAL" type="string"/>
<Field name="SUBSIDY_TOTAL" type="string"/>
<Field name="SUBSIDY_BY_EMP_TOTAL" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_TOT" type="string"/>
<Field name="SUBSIDY_SUM_BY_EMP_TOT" type="string"/>
<Field name="EMP_COUNT_EITC" type="string"/>
<Field name="SUBSIDY_TOTAL_EITC" type="string"/>
<Field name="SUBSIDY_BY_EMP_EITC" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_EITC" type="string"/>
<Field name="EMP_COUNT_SNAP" type="string"/>
<Field name="SUBSIDY_TOTAL_SNAP" type="string"/>
<Field name="SUBSIDY_BY_EMP_SNAP" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_SNAP" type="string"/>
<Field name="EMP_COUNT_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_TOTAL_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_BY_EMP_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID" type="string"/>
<Field name="EMP_COUNT_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_TOTAL_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_BY_EMP_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID" type="string"/>
<Field name="EMP_COUNT_ACA" type="string"/>
<Field name="SUBSIDY_TOTAL_ACA" type="string"/>
<Field name="SUBSIDY_BY_EMP_ACA" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_ACA" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata3" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="," name="Living_Wage_Averages" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" type="delimited">
<Field name="Ticker" type="string"/>
<Field name="Subsidiary" type="string"/>
<Field name="Avg_lw_unweighted" type="string"/>
<Field name="Avg_lw_weighted" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata1" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="," name="Report_Details_County_Ticker" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" type="delimited">
<Field name="STATE_COUNTY_FIPS" type="string"/>
<Field name="TICKER" type="string"/>
<Field name="SUBSIDIARY" type="string"/>
<Field name="JOC" type="string"/>
<Field name="HOURLY_WAGE_RAW" type="string"/>
<Field name="MINIMUM_WAGE" type="string"/>
<Field name="LIVING_WAGE_HOURLY" type="string"/>
<Field name="EMP_COUNT_TOTAL" type="string"/>
<Field name="EMP_COUNT_SUBSIDY_TOTAL" type="string"/>
<Field name="SUBSIDY_TOTAL" type="string"/>
<Field name="SUBSIDY_BY_EMP_TOTAL" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_TOT" type="string"/>
<Field name="SUBSIDY_SUM_BY_EMP_TOT" type="string"/>
<Field name="EMP_COUNT_EITC" type="string"/>
<Field name="SUBSIDY_TOTAL_EITC" type="string"/>
<Field name="SUBSIDY_BY_EMP_EITC" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_EITC" type="string"/>
<Field name="EMP_COUNT_SNAP" type="string"/>
<Field name="SUBSIDY_TOTAL_SNAP" type="string"/>
<Field name="SUBSIDY_BY_EMP_SNAP" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_SNAP" type="string"/>
<Field name="EMP_COUNT_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_TOTAL_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_BY_EMP_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID" type="string"/>
<Field name="EMP_COUNT_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_TOTAL_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_BY_EMP_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID" type="string"/>
<Field name="EMP_COUNT_ACA" type="string"/>
<Field name="SUBSIDY_TOTAL_ACA" type="string"/>
<Field name="SUBSIDY_BY_EMP_ACA" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_ACA" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata2" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="," name="Report_Summary_Ticker" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" type="delimited">
<Field name="TICKER" type="string"/>
<Field name="SUBSIDIARY" type="string"/>
<Field name="EMP_COUNT_TOTAL" type="string"/>
<Field name="EMP_COUNT_SUBSIDY_TOTAL" type="string"/>
<Field name="SUBSIDY_TOTAL" type="string"/>
<Field name="SUBSIDY_BY_EMP_TOTAL" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_TOT" type="string"/>
<Field name="SUBSIDY_SUM_BY_EMP_TOT" type="string"/>
<Field name="EMP_COUNT_EITC" type="string"/>
<Field name="SUBSIDY_TOTAL_EITC" type="string"/>
<Field name="SUBSIDY_BY_EMP_EITC" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_EITC" type="string"/>
<Field name="EMP_COUNT_SNAP" type="string"/>
<Field name="SUBSIDY_TOTAL_SNAP" type="string"/>
<Field name="SUBSIDY_BY_EMP_SNAP" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_SNAP" type="string"/>
<Field name="EMP_COUNT_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_TOTAL_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_BY_EMP_ADULT_MEDICAID" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID" type="string"/>
<Field name="EMP_COUNT_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_TOTAL_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_BY_EMP_CHILD_MEDICAID" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID" type="string"/>
<Field name="EMP_COUNT_ACA" type="string"/>
<Field name="SUBSIDY_TOTAL_ACA" type="string"/>
<Field name="SUBSIDY_BY_EMP_ACA" type="string"/>
<Field name="SUBSIDY_ABS_BY_EMP_ACA" type="string"/>
</Record>
</Metadata>
<Connection database="DSS" dbURL="jdbc:dss://secure.gooddata.com/gdc/dss/instances/d68eb234fff8f2750cbf7dd02b20fd0e" id="JDBC0" jdbcSpecific="DSS" name="GOODDATA_DEV" password="justcapital1!" type="JDBC" user="ps-etl+justcapital_research@gooddata.com"/>
<Property fileURL="graph/local/wage-local-parameters.prm" id="GraphParameter0"/>
<Property id="GraphParameter2" name="REPORTFILEPATH_DETAILS_COUNTY" value="${REPORTS_DIR}/Details_County.csv"/>
<Property id="GraphParameter3" name="REPORTFILEPATH_DETAILS_COUNTY_TICKER" value="${REPORTS_DIR}/Details_County_Ticker.csv"/>
<Property id="GraphParameter4" name="REPORTFILEPATH_SUMMARY_TICKER" value="${REPORTS_DIR}/Summary_Ticker.csv"/>
<Property id="GraphParameter5" name="REPORTS_DIR" value="${REPORTS_DIR_LW_LOCAL}/subsidy"/>
<Property fileURL="wage.prm" id="GraphParameter6"/>
<Property fileURL="workspace.prm" id="GraphParameter72"/>
<Dictionary/>
</Global>
<Phase number="2">
<Node enabled="enabled" guiName="Reformat" guiX="246" guiY="29" id="REFORMAT1" type="REFORMAT">
<attr name="transform"><![CDATA[//#CTL2

// Transforms input record into output record.
function integer transform() {
	$out.0.* = $in.0.*;

	return ALL;
}

// Called during component initialization.
// function boolean init() {}

// Called during each graph run before the transform is executed. May be used to allocate and initialize resources
// required by the transform. All resources allocated within this method should be released
// by the postExecute() method.
// function void preExecute() {}

// Called only if transform() throws an exception.
// function integer transformOnError(string errorMessage, string stackTrace) {}

// Called during each graph run after the entire transform was executed. Should be used to free any resources
// allocated within the preExecute() method.
// function void postExecute() {}

// Called to return a user-defined error message when an error occurs.
// function string getMessage() {}
]]></attr>
</Node>
<Node enabled="enabled" guiName="Reformat" guiX="246" guiY="252" id="REFORMAT2" type="REFORMAT">
<attr name="transform"><![CDATA[//#CTL2

// Transforms input record into output record.
function integer transform() {
	$out.0.* = $in.0.*;

	return ALL;
}

// Called during component initialization.
// function boolean init() {}

// Called during each graph run before the transform is executed. May be used to allocate and initialize resources
// required by the transform. All resources allocated within this method should be released
// by the postExecute() method.
// function void preExecute() {}

// Called only if transform() throws an exception.
// function integer transformOnError(string errorMessage, string stackTrace) {}

// Called during each graph run after the entire transform was executed. Should be used to free any resources
// allocated within the preExecute() method.
// function void postExecute() {}

// Called to return a user-defined error message when an error occurs.
// function string getMessage() {}
]]></attr>
</Node>
<Node enabled="enabled" guiName="Reformat" guiX="246" guiY="140" id="REFORMAT3" type="REFORMAT">
<attr name="transform"><![CDATA[//#CTL2

// Transforms input record into output record.
function integer transform() {
	$out.0.* = $in.0.*;

	return ALL;
}

// Called during component initialization.
// function boolean init() {}

// Called during each graph run before the transform is executed. May be used to allocate and initialize resources
// required by the transform. All resources allocated within this method should be released
// by the postExecute() method.
// function void preExecute() {}

// Called only if transform() throws an exception.
// function integer transformOnError(string errorMessage, string stackTrace) {}

// Called during each graph run after the entire transform was executed. Should be used to free any resources
// allocated within the preExecute() method.
// function void postExecute() {}

// Called to return a user-defined error message when an error occurs.
// function string getMessage() {}
]]></attr>
</Node>
<Node dbConnection="JDBC0" enabled="enabled" guiName="Select Details by County" guiX="31" guiY="140" id="SELECT_DETAILS_BY_COUNTY" type="DB_INPUT_TABLE">
<attr name="sqlQuery"><![CDATA[select
  $STATE_COUNTY_FIPS:=STATE_COUNTY_FIPS,
  $EMP_COUNT_TOTAL:=cast(round(EMP_COUNT_TOTAL,3) as numeric(16,3)),
  $EMP_COUNT_SUBSIDY_TOTAL:=cast(round(EMP_COUNT_SUBSIDY_TOTAL,3) as numeric(16,3)),
  $SUBSIDY_TOTAL:=concat('$',cast(round(SUBSIDY_TOTAL,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_TOTAL:=concat('$',cast(round(SUBSIDY_BY_EMP_TOTAL,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_TOT:=concat('$',cast(round((SUBSIDY_ABS_BY_EMP_EITC + 
    SUBSIDY_ABS_BY_EMP_SNAP + 
    SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID + 
    SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID + 
    SUBSIDY_ABS_BY_EMP_ACA),2) as numeric(16,2))) SUBSIDY_ABS_BY_EMP_TOT,
  $SUBSIDY_SUM_BY_EMP_TOT:=concat('$',cast(round((SUBSIDY_BY_EMP_EITC + 
    SUBSIDY_BY_EMP_SNAP + 
    SUBSIDY_BY_EMP_ADULT_MEDICAID + 
    SUBSIDY_BY_EMP_CHILD_MEDICAID + 
    SUBSIDY_BY_EMP_ACA),2) as numeric(16,2))) SUBSIDY_SUM_BY_EMP_TOT,
  $EMP_COUNT_EITC:=cast(round(EMP_COUNT_EITC,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_EITC:=concat('$',cast(round(SUBSIDY_TOTAL_EITC,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_EITC:=concat('$',cast(round(SUBSIDY_BY_EMP_EITC,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_EITC:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_EITC,2) as numeric(16,2))),
  $EMP_COUNT_SNAP:=cast(round(EMP_COUNT_SNAP,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_SNAP:=concat('$',cast(round(SUBSIDY_TOTAL_SNAP,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_SNAP:=concat('$',cast(round(SUBSIDY_BY_EMP_SNAP,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_SNAP:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_SNAP,2) as numeric(16,2))),
  $EMP_COUNT_ADULT_MEDICAID:=cast(round(EMP_COUNT_ADULT_MEDICAID,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_TOTAL_ADULT_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_BY_EMP_ADULT_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID,2) as numeric(16,2))),
  $EMP_COUNT_CHILD_MEDICAID:=cast(round(EMP_COUNT_CHILD_MEDICAID,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_TOTAL_CHILD_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_BY_EMP_CHILD_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID,2) as numeric(16,2))),
  $EMP_COUNT_ACA:=cast(round(EMP_COUNT_ACA,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_ACA:=concat('$',cast(round(SUBSIDY_TOTAL_ACA,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_ACA:=concat('$',cast(round(SUBSIDY_BY_EMP_ACA,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_ACA:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_ACA,2) as numeric(16,2)))
from (
  select
    STATE_COUNTY_FIPS,
    sum(EMP_COUNT_TOTAL) EMP_COUNT_TOTAL,
    sum(EMP_COUNT_SUBSIDY_TOTAL) EMP_COUNT_SUBSIDY_TOTAL,
    sum(SUBSIDY_TOTAL) SUBSIDY_TOTAL,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_TOTAL,
    sum(EMP_COUNT_EITC) EMP_COUNT_EITC,
    sum(SUBSIDY_TOTAL_EITC) SUBSIDY_TOTAL_EITC,
    case
      when sum(EMP_COUNT_EITC) > 0 then (sum(SUBSIDY_TOTAL_EITC)/sum(EMP_COUNT_EITC))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_EITC,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_EITC)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_EITC,
    sum(EMP_COUNT_SNAP) EMP_COUNT_SNAP,
    sum(SUBSIDY_TOTAL_SNAP) SUBSIDY_TOTAL_SNAP,
    case
      when sum(EMP_COUNT_SNAP) > 0 then (sum(SUBSIDY_TOTAL_SNAP)/sum(EMP_COUNT_SNAP))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_SNAP,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_SNAP)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_SNAP,
    sum(EMP_COUNT_ADULT_MEDICAID) EMP_COUNT_ADULT_MEDICAID,
    sum(SUBSIDY_TOTAL_ADULT_MEDICAID) SUBSIDY_TOTAL_ADULT_MEDICAID,
    case
      when sum(EMP_COUNT_ADULT_MEDICAID) > 0 then (sum(SUBSIDY_TOTAL_ADULT_MEDICAID)/sum(EMP_COUNT_ADULT_MEDICAID))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_ADULT_MEDICAID,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_ADULT_MEDICAID)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID,
    sum(EMP_COUNT_CHILD_MEDICAID) EMP_COUNT_CHILD_MEDICAID,
    sum(SUBSIDY_TOTAL_CHILD_MEDICAID) SUBSIDY_TOTAL_CHILD_MEDICAID,
    case
      when sum(EMP_COUNT_CHILD_MEDICAID) > 0 then (sum(SUBSIDY_TOTAL_CHILD_MEDICAID)/sum(EMP_COUNT_CHILD_MEDICAID))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_CHILD_MEDICAID,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_CHILD_MEDICAID)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID,
    sum(EMP_COUNT_ACA) EMP_COUNT_ACA,
    sum(SUBSIDY_TOTAL_ACA) SUBSIDY_TOTAL_ACA,
    case
      when sum(EMP_COUNT_ACA) > 0 then (sum(SUBSIDY_TOTAL_ACA)/sum(EMP_COUNT_ACA))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_ACA,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_ACA)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_ACA
  from ${TABLE_SUBSIDY_DETAIL} d
  left join ${TABLE_COMPANY_LIVING_WAGE} c on c.ticker = d.ticker and c.has_subsidiaries and d.subsidiary is null
  where c.ticker is null
  group by state_county_fips
) t
order by state_county_fips;]]></attr>
</Node>
<Node dbConnection="JDBC0" enabled="enabled" guiName="Select Details by County, Ticker" guiX="6" guiY="252" id="SELECT_DETAILS_BY_COUNTY_TICKER" type="DB_INPUT_TABLE">
<attr name="sqlQuery"><![CDATA[select
  $STATE_COUNTY_FIPS:=STATE_COUNTY_FIPS,
  $TICKER:=TICKER,
  $SUBSIDIARY:=SUBSIDIARY,
  $JOC:=JOC,
  $HOURLY_WAGE_RAW:=concat('$',cast(round(HOURLY_WAGE_RAW,2) as numeric(16,2))),
  $MINIMUM_WAGE:=concat('$',cast(round(MINIMUM_WAGE,2) as numeric(16,2))),
  $LIVING_WAGE_HOURLY:=concat('$',cast(round(LIVING_WAGE_HOURLY,2) as numeric(16,2))),
  $EMP_COUNT_TOTAL:=cast(round(EMP_COUNT_TOTAL,3) as numeric(16,3)),
  $EMP_COUNT_SUBSIDY_TOTAL:=cast(round(EMP_COUNT_SUBSIDY_TOTAL,3) as numeric(16,3)),
  $SUBSIDY_TOTAL:=concat('$',cast(round(SUBSIDY_TOTAL,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_TOTAL:=concat('$',cast(round(SUBSIDY_BY_EMP_TOTAL,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_TOT:=concat('$',cast(round((SUBSIDY_ABS_BY_EMP_EITC + 
    SUBSIDY_ABS_BY_EMP_SNAP + 
    SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID + 
    SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID + 
    SUBSIDY_ABS_BY_EMP_ACA),2) as numeric(16,2))) SUBSIDY_ABS_BY_EMP_TOT,
  $SUBSIDY_SUM_BY_EMP_TOT:=concat('$',cast(round((SUBSIDY_BY_EMP_EITC + 
    SUBSIDY_BY_EMP_SNAP + 
    SUBSIDY_BY_EMP_ADULT_MEDICAID + 
    SUBSIDY_BY_EMP_CHILD_MEDICAID + 
    SUBSIDY_BY_EMP_ACA),2) as numeric(16,2))) SUBSIDY_SUM_BY_EMP_TOT,
  $EMP_COUNT_EITC:=cast(round(EMP_COUNT_EITC,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_EITC:=concat('$',cast(round(SUBSIDY_TOTAL_EITC,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_EITC:=concat('$',cast(round(SUBSIDY_BY_EMP_EITC,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_EITC:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_EITC,2) as numeric(16,2))),
  $EMP_COUNT_SNAP:=cast(round(EMP_COUNT_SNAP,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_SNAP:=concat('$',cast(round(SUBSIDY_TOTAL_SNAP,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_SNAP:=concat('$',cast(round(SUBSIDY_BY_EMP_SNAP,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_SNAP:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_SNAP,2) as numeric(16,2))),
  $EMP_COUNT_ADULT_MEDICAID:=cast(round(EMP_COUNT_ADULT_MEDICAID,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_TOTAL_ADULT_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_BY_EMP_ADULT_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID,2) as numeric(16,2))),
  $EMP_COUNT_CHILD_MEDICAID:=cast(round(EMP_COUNT_CHILD_MEDICAID,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_TOTAL_CHILD_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_BY_EMP_CHILD_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID,2) as numeric(16,2))),
  $EMP_COUNT_ACA:=cast(round(EMP_COUNT_ACA,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_ACA:=concat('$',cast(round(SUBSIDY_TOTAL_ACA,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_ACA:=concat('$',cast(round(SUBSIDY_BY_EMP_ACA,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_ACA:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_ACA,2) as numeric(16,2)))
from (
  select
    STATE_COUNTY_FIPS,
    TICKER,
    SUBSIDIARY,
    JOC,
    HOURLY_WAGE_RAW,
    STATE_MINIMUM_WAGE MINIMUM_WAGE,
    LIVING_WAGE_HOURLY,
    EMP_COUNT_TOTAL,
    EMP_COUNT_SUBSIDY_TOTAL,
    SUBSIDY_TOTAL,
    case
      when emp_count_subsidy_total > 0 then (subsidy_total/emp_count_subsidy_total)/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_TOTAL,
    EMP_COUNT_EITC,
    SUBSIDY_TOTAL_EITC,
    case
      when emp_count_eitc > 0 then (subsidy_total_eitc/emp_count_eitc)/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_EITC,
    case
      when EMP_COUNT_SUBSIDY_TOTAL > 0 then (SUBSIDY_TOTAL_EITC/EMP_COUNT_SUBSIDY_TOTAL)/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_EITC,
    EMP_COUNT_SNAP,
    SUBSIDY_TOTAL_SNAP,
    case
      when emp_count_snap > 0 then (subsidy_total_snap/emp_count_snap)/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_SNAP,
    case
      when EMP_COUNT_SUBSIDY_TOTAL > 0 then (SUBSIDY_TOTAL_SNAP/EMP_COUNT_SUBSIDY_TOTAL)/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_SNAP,
    EMP_COUNT_ADULT_MEDICAID,
    SUBSIDY_TOTAL_ADULT_MEDICAID,
    case
      when emp_count_adult_medicaid > 0 then (subsidy_total_adult_medicaid/emp_count_adult_medicaid)/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_ADULT_MEDICAID,
    case
      when EMP_COUNT_SUBSIDY_TOTAL > 0 then (SUBSIDY_TOTAL_ADULT_MEDICAID/EMP_COUNT_SUBSIDY_TOTAL)/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID,
    EMP_COUNT_CHILD_MEDICAID,
    SUBSIDY_TOTAL_CHILD_MEDICAID,
    case
      when emp_count_child_medicaid > 0 then (subsidy_total_child_medicaid/emp_count_child_medicaid)/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_CHILD_MEDICAID,
    case
      when EMP_COUNT_SUBSIDY_TOTAL > 0 then (SUBSIDY_TOTAL_CHILD_MEDICAID/EMP_COUNT_SUBSIDY_TOTAL)/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID,
    EMP_COUNT_ACA,
    SUBSIDY_TOTAL_ACA,
    case
      when EMP_COUNT_ACA > 0 then (SUBSIDY_TOTAL_ACA/EMP_COUNT_ACA)/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_ACA,
    case
      when EMP_COUNT_SUBSIDY_TOTAL > 0 then (SUBSIDY_TOTAL_ACA/EMP_COUNT_SUBSIDY_TOTAL)/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_ACA
  from ${TABLE_SUBSIDY_DETAIL}
) t
order by state_county_fips, ticker, subsidiary, hourly_wage_raw;]]></attr>
</Node>
<Node dbConnection="JDBC0" enabled="enabled" guiName="Select Summary by Ticker" guiX="31" guiY="29" id="SELECT_SUMMARY_BY_TICKER" type="DB_INPUT_TABLE">
<attr name="sqlQuery"><![CDATA[select
  $TICKER:=TICKER,
  $SUBSIDIARY:=SUBSIDIARY,
  $EMP_COUNT_TOTAL:=cast(round(EMP_COUNT_TOTAL,3) as numeric(16,3)),
  $EMP_COUNT_SUBSIDY_TOTAL:=cast(round(EMP_COUNT_SUBSIDY_TOTAL,3) as numeric(16,3)),
  $SUBSIDY_TOTAL:=concat('$',cast(round(SUBSIDY_TOTAL,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_TOTAL:=concat('$',cast(round(SUBSIDY_BY_EMP_TOTAL,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_TOT:=concat('$',cast(round((SUBSIDY_ABS_BY_EMP_EITC + 
    SUBSIDY_ABS_BY_EMP_SNAP + 
    SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID + 
    SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID + 
    SUBSIDY_ABS_BY_EMP_ACA),2) as numeric(16,2))) SUBSIDY_ABS_BY_EMP_TOT,
  $SUBSIDY_SUM_BY_EMP_TOT:=concat('$',cast(round((SUBSIDY_BY_EMP_EITC + 
    SUBSIDY_BY_EMP_SNAP + 
    SUBSIDY_BY_EMP_ADULT_MEDICAID + 
    SUBSIDY_BY_EMP_CHILD_MEDICAID + 
    SUBSIDY_BY_EMP_ACA),2) as numeric(16,2))) SUBSIDY_SUM_BY_EMP_TOT,
  $EMP_COUNT_EITC:=cast(round(EMP_COUNT_EITC,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_EITC:=concat('$',cast(round(SUBSIDY_TOTAL_EITC,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_EITC:=concat('$',cast(round(SUBSIDY_BY_EMP_EITC,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_EITC:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_EITC,2) as numeric(16,2))),
  $EMP_COUNT_SNAP:=cast(round(EMP_COUNT_SNAP,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_SNAP:=concat('$',cast(round(SUBSIDY_TOTAL_SNAP,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_SNAP:=concat('$',cast(round(SUBSIDY_BY_EMP_SNAP,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_SNAP:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_SNAP,2) as numeric(16,2))),
  $EMP_COUNT_ADULT_MEDICAID:=cast(round(EMP_COUNT_ADULT_MEDICAID,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_TOTAL_ADULT_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_BY_EMP_ADULT_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID,2) as numeric(16,2))),
  $EMP_COUNT_CHILD_MEDICAID:=cast(round(EMP_COUNT_CHILD_MEDICAID,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_TOTAL_CHILD_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_BY_EMP_CHILD_MEDICAID,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID,2) as numeric(16,2))),
  $EMP_COUNT_ACA:=cast(round(EMP_COUNT_ACA,3) as numeric(16,3)),
  $SUBSIDY_TOTAL_ACA:=concat('$',cast(round(SUBSIDY_TOTAL_ACA,2) as numeric(16,2))),
  $SUBSIDY_BY_EMP_ACA:=concat('$',cast(round(SUBSIDY_BY_EMP_ACA,2) as numeric(16,2))),
  $SUBSIDY_ABS_BY_EMP_ACA:=concat('$',cast(round(SUBSIDY_ABS_BY_EMP_ACA,2) as numeric(16,2)))
from (
  select
    TICKER,
    SUBSIDIARY,
    sum(EMP_COUNT_TOTAL) EMP_COUNT_TOTAL,
    sum(EMP_COUNT_SUBSIDY_TOTAL) EMP_COUNT_SUBSIDY_TOTAL,
    sum(SUBSIDY_TOTAL) SUBSIDY_TOTAL,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_TOTAL,
    sum(EMP_COUNT_EITC) EMP_COUNT_EITC,
    sum(SUBSIDY_TOTAL_EITC) SUBSIDY_TOTAL_EITC,
    case
      when sum(EMP_COUNT_EITC) > 0 then (sum(SUBSIDY_TOTAL_EITC)/sum(EMP_COUNT_EITC))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_EITC,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_EITC)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_EITC,
    sum(EMP_COUNT_SNAP) EMP_COUNT_SNAP,
    sum(SUBSIDY_TOTAL_SNAP) SUBSIDY_TOTAL_SNAP,
    case
      when sum(EMP_COUNT_SNAP) > 0 then (sum(SUBSIDY_TOTAL_SNAP)/sum(EMP_COUNT_SNAP))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_SNAP,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_SNAP)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_SNAP,
    sum(EMP_COUNT_ADULT_MEDICAID) EMP_COUNT_ADULT_MEDICAID,
    sum(SUBSIDY_TOTAL_ADULT_MEDICAID) SUBSIDY_TOTAL_ADULT_MEDICAID,
    case
      when sum(EMP_COUNT_ADULT_MEDICAID) > 0 then (sum(SUBSIDY_TOTAL_ADULT_MEDICAID)/sum(EMP_COUNT_ADULT_MEDICAID))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_ADULT_MEDICAID,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_ADULT_MEDICAID)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_ADULT_MEDICAID,
    sum(EMP_COUNT_CHILD_MEDICAID) EMP_COUNT_CHILD_MEDICAID,
    sum(SUBSIDY_TOTAL_CHILD_MEDICAID) SUBSIDY_TOTAL_CHILD_MEDICAID,
    case
      when sum(EMP_COUNT_CHILD_MEDICAID) > 0 then (sum(SUBSIDY_TOTAL_CHILD_MEDICAID)/sum(EMP_COUNT_CHILD_MEDICAID))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_CHILD_MEDICAID,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_CHILD_MEDICAID)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_CHILD_MEDICAID,
    sum(EMP_COUNT_ACA) EMP_COUNT_ACA,
    sum(SUBSIDY_TOTAL_ACA) SUBSIDY_TOTAL_ACA,
    case
      when sum(EMP_COUNT_ACA) > 0 then (sum(SUBSIDY_TOTAL_ACA)/sum(EMP_COUNT_ACA))/1500.0
      else 0.0
    end SUBSIDY_BY_EMP_ACA,
    case
      when sum(EMP_COUNT_SUBSIDY_TOTAL) > 0 then (sum(SUBSIDY_TOTAL_ACA)/sum(EMP_COUNT_SUBSIDY_TOTAL))/1500.0
      else 0.0
    end SUBSIDY_ABS_BY_EMP_ACA
  from ${TABLE_SUBSIDY_DETAIL}
  group by ticker, subsidiary
) t
order by ticker, subsidiary;]]></attr>
</Node>
<Node enabled="enabled" fileURL="${REPORTFILEPATH_SUMMARY_TICKER}" guiName="Write Report" guiX="424" guiY="29" id="WRITE_REPORT" outputFieldNames="true" type="DATA_WRITER"/>
<Node enabled="enabled" fileURL="${REPORTFILEPATH_DETAILS_COUNTY}" guiName="Write Report" guiX="424" guiY="140" id="WRITE_REPORT1" outputFieldNames="true" type="DATA_WRITER"/>
<Node enabled="enabled" fileURL="${REPORTFILEPATH_DETAILS_COUNTY_TICKER}" guiName="Write Report" guiX="424" guiY="252" id="WRITE_REPORT2" outputFieldNames="true" type="DATA_WRITER"/>
<Edge fromNode="REFORMAT1:0" guiBendpoints="" guiRouter="Manhattan" id="Edge15" inPort="Port 0 (in)" metadata="Metadata2" outPort="Port 0 (out)" toNode="WRITE_REPORT:0"/>
<Edge fromNode="REFORMAT2:0" guiBendpoints="" guiRouter="Manhattan" id="Edge19" inPort="Port 0 (in)" metadata="Metadata1" outPort="Port 0 (out)" toNode="WRITE_REPORT2:0"/>
<Edge fromNode="REFORMAT3:0" guiBendpoints="" guiRouter="Manhattan" id="Edge17" inPort="Port 0 (in)" metadata="Metadata0" outPort="Port 0 (out)" toNode="WRITE_REPORT1:0"/>
<Edge fromNode="SELECT_DETAILS_BY_COUNTY:0" guiBendpoints="" guiRouter="Manhattan" id="Edge16" inPort="Port 0 (in)" metadata="Metadata0" outPort="Port 0 (out)" toNode="REFORMAT3:0"/>
<Edge fromNode="SELECT_DETAILS_BY_COUNTY_TICKER:0" guiBendpoints="" guiRouter="Manhattan" id="Edge18" inPort="Port 0 (in)" metadata="Metadata1" outPort="Port 0 (out)" toNode="REFORMAT2:0"/>
<Edge fromNode="SELECT_SUMMARY_BY_TICKER:0" guiBendpoints="" guiRouter="Manhattan" id="Edge14" inPort="Port 0 (in)" metadata="Metadata2" outPort="Port 0 (out)" toNode="REFORMAT1:0"/>
</Phase>
</Graph>
